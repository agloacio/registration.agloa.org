const api=wp.customize,controlApi=parent.wp.customize;export class Preview{bindEvents(){$(()=>this._bindTypography())}getCSS(e,t="bgtfw_headings_typography"){var n,i,a,o,s,p,r=e=>{var t=parseInt(e),n=e.replace(t,""),i=n.match(/(em|ex|%|px|cm|mm|in|pt|pc|rem)/);return""===n&&(n="px"),t+(n=i?i[0]:"px")};_.isUndefined(e)&&(e=api(t)()),p=(p=t.replace("bgtfw_","")).replace("_typography","");try{e=JSON.parse(e)}catch(e){}n=e.variant,i=n?parseInt(n):"initial",a=n?n.replace(i,""):"initial";let d="";if("bgtfw_headings_typography"===t){o=parseInt(api("bgtfw_headings_font_size")());let e=(s=(s=api("bgtfw_headings_font_size")().replace(o,""))||"px").match(/(em|ex|%|px|cm|mm|in|pt|pc|rem)/);s=e?e[0]:"px"}if(_.each(BOLDGRID.CUSTOMIZER.data.customizerOptions.typography.selectors,function(n,l){var c;"headings"===n.type&&"bgtfw_headings_typography"===t?(c=o*n.amount,"ceil"===n.round&&(c=Math.ceil(c)),"floor"===n.round&&(c=Math.floor(c)),i&&a?(d+=l+"{font-size:"+c+s+";",d+="font-style:"+a+";",d+="font-weight:"+i+";}"):i&&(d+=l+"{font-size:"+c+s+";",d+="font-weight:"+i+";}"),d+=l+"{font-size:"+c+s+";}"):p===n.type&&(d+=l+"{font-size:"+r(e["font-size"])+";",i&&a?(d+="font-style:"+a+";",d+="font-weight:"+i+";"):i?d+="font-weight:"+i+";":a&&(d+="font-style:"+a+";"),d+="}")}),p.includes("menu")){let t=p.replace(/_/g,"-");t=t.replace("menu-",""),d+=(t="#"+t+"-menu li.menu-item > a")+"{font-size:"+r(e["font-size"])+";",i&&a?(d+="font-style:"+a+";",d+="font-weight:"+i+";"):i?d+="font-weight:"+i+";":a&&(d+="font-style:"+a+";"),d+="}"}return d}addStyle(e,t="bgtfw_headings_typography"){var n=t.replace(/_/g,"-");if(document.getElementById(n))document.getElementById(n).innerHTML=e;else{let t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.id=n,i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}document.getElementById("kirki-postmessage-"+t)&&$("#"+n).insertAfter("#kirki-postmessage-"+t)}_bindTypography(){var e=[];controlApi.control.each(t=>{"kirki-typography"===t.params.type&&e.push(t.id)}),e.forEach(e=>this.addTypographyOverride(e)),e.forEach(e=>{api(e,t=>t.bind(t=>this.addStyle(this.getCSS(t,e),e)))}),api("bgtfw_headings_font_size",e=>e.bind(e=>this.addStyle(this.getCSS(e))))}addTypographyOverride(e){api(e,function(t){t.bind(function(t){var n,i,a;if(!_.isString(t))return;a=JSON.parse(t),/\s/.test(a["font-family"])&&(a["font-family"]='"'+a["font-family"]+'"'),kirkiPostMessageFields.forEach(function(t){!n&&e===t.id&&t.output[0].element&&(n=t.output[0].element)}),i=n+" {font-family: "+a["font-family"]+";}";let o=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",s.id=e+"-font-families",s.styleSheet?s.styleSheet.cssText=i:s.appendChild(document.createTextNode(i)),o.appendChild(s)})})}}